/**
 * Created by dhnishi on 4/11/15.
 */

/// <reference path="Hand.ts"/>
/// <reference path="HandEvaluator.ts"/>
/// <reference path="Entity.ts"/>


class BattleEvaluator {

    /**
     * Returns if the attack hits using rules based on the D&D 3.5 "Players Roll Add the Dice" rules.
     * An attacker's attack score is generated by their hand value + their attack bonus + 10.
     * The defense check is generated by their hand value + their armor class modifier.
     * @param attackHand
     * @param defenseHand
     * @returns {boolean}
     */
    static doesAttackHit(attacker : EntityInBattle, defender : EntityInBattle) {
        // TODO: Replace this with real evaluators from the players themselves.
        var evaluator = new HandEvaluator;
        // TODO: Replace this with real stats when stats are implemented.
        var attackRoll = evaluator.evaluate(attacker.hand) + attacker.getAttackBonus() + 10;
        var defenseRoll = evaluator.evaluate(defender.hand) + defender.getAC();
        return attackRoll > defenseRoll;
    }

    static getAttackDamageDealt(attackHand : Hand, expectedDamage : number) {
        var evaluator = new HandEvaluator;
        return Math.floor(expectedDamage * evaluator.evaluate(attackHand) / 21)
    }
}